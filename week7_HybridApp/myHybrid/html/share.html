<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		<title></title>
		<script src="../js/mui.min.js"></script>
		<link href="../css/mui.min.css" rel="stylesheet"/>
	</head>
	<body>
		<div class="mui-content">
			<ul class="shareList mui-row">
				
			</ul>
		</div>
		<script>
			document.addEventListener("plusready", onPlusReady, false);

			let serviceList = null;
			function onPlusReady() {
				let shareList = document.querySelector('.shareList');
				plus.share.getServices((services) => {
					console.log('services:', services);
					serviceList = services;
					shareList.innerHTML = services.map((item,idx) => {
						return `<li class="mui-table-view-cell mui-col-xs-3">
									<a class="mui-navigate-right" onclick="share(${idx})">${item.description}</a>
								</li>`
					}).join('')
				});
			}
			
			function share(idx){
				let currentService = serviceList[idx];
				if(currentService.authenticated){
					
					currentService.send({content:'hello my name is laoxie'},()=>{
						console.log('分享成功')
					})
				}else{
					 plus.nativeUI.alert(currentService.description +'未认证', ()=>{
						 
					 }, '分享失败', '确定');
				}
			}
		</script>
	</body>
</html>
